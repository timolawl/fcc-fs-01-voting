!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function addOption(btnCounter){var button=document.createElement("button");button.className="form__button--delete",button.id="option-"+btnCounter,button.type="button",button.textContent="X";var input=document.createElement("input");input.className="form__input form__input--options",input.setAttribute("type","text"),input.setAttribute("name","options"),input.setAttribute("placeholder","New Option"),input.setAttribute("pattern","^[a-zA-Z0-9$@#&*+-][a-zA-Z0-9$@#&%*+'\"_/, .?!-]{0,200}$");var div=document.createElement("div");div.className="form__options--option",div.appendChild(input),div.appendChild(button),document.querySelector(".form__options").appendChild(div)}function checkForm(path){function validateInput(){var unique=void 0,pw=void 0,pwConfirm=void 0;submitBtn.disabled=!0,Array.from(inputs).every(function(input){return input.value.match(input.getAttribute("pattern"))})&&("createpoll"===path&&inputs.length>=3?(unique=new Set(Array.from(inputs).map(function(input){return input.value})),inputs.length===unique.size&&(submitBtn.disabled=!1)):"createpoll"!==path&&("signup"===path?(pw=form.querySelector(".form__input--password"),pwConfirm=form.querySelector(".form__input--confirm"),pw.value===pwConfirm.value?(pw.style.outline="initial",pwConfirm.style.outline="initial",submitBtn.disabled=!1):(pw.style.outline="1px solid red",pwConfirm.style.outline="1px solid red")):submitBtn.disabled=!1))}var form=document.querySelector("form"),inputs=document.getElementsByClassName("form__input"),submitBtn=document.querySelector('input[type="submit"]');submitBtn.disabled=!0,form.onkeyup=validateInput,form.onclick=validateInput}function displayModal(option){document.querySelector(".modal__overlay").classList.remove("visibility--hide");var closeOptions=Array.from(document.querySelectorAll(".modal__close"));switch(closeOptions.push.call(closeOptions,document.querySelector(".modal__overlay")),document.querySelector(".modal__delete--no")&&closeOptions.push.call(closeOptions,document.querySelector(".modal__delete--no")),closeOptions.push.apply(closeOptions,Array.from(document.querySelectorAll(".modal__submit"))),closeOptions.forEach(function(e){return e.addEventListener("click",function(event){document.querySelector(".modal__overlay").classList.add("visibility--hide"),Array.prototype.forEach.call(document.querySelectorAll(".modal"),function(e){return e.classList.add("visibility--hide")}),document.querySelector(".modal--share")&&document.querySelector(".modal__flash-message").classList.add("display--hide")})}),option){case"vote":document.querySelector(".modal--vote").classList.remove("visibility--hide");break;case"new-option":document.querySelector(".modal__form--new-option").reset(),document.querySelector(".modal--new-option").classList.remove("visibility--hide");break;case"share":document.querySelector(".modal--share").classList.remove("visibility--hide"),document.querySelector(".modal__share--link-box").select(),document.querySelector(".modal__share--clipboard-button").addEventListener("click",copyPollLink);break;case"delete":document.querySelector(".modal--delete-poll").classList.remove("visibility--hide");break;default:console.log("wat")}}function copyPollLink(){document.querySelector(".modal__share--link-box").select(),document.execCommand("copy"),document.querySelector(".modal__flash-message").classList.remove("display--hide")}var socket=io.connect("http://localhost:5000");window.onload=function(){if(location.pathname.match(/^\/$/)&&socket.emit("change room",{room:location.pathname}),location.pathname.match(/^\/poll\/[0-9a-f-]+$/)&&socket.emit("change room",{room:location.pathname.slice(6)}),location.pathname.match(/^\/(?:signup|login|reset|createpoll|mypolls)\/?/i)&&socket.emit("leave room",{path:location.pathname.toLowerCase().slice(1)}),location.pathname.match(/^\/$/)&&(console.log("home"),socket.emit("list all polls",{}),socket.on("populate all polls",function(data){for(var parentNode=document.querySelector(".polls"),i=0;i<data.titles.length;i++){var newDiv=document.createElement("div");newDiv.className="poll__element--text",newDiv.textContent=data.titles[i];var newLink=document.createElement("a");newLink.className="poll__element--link",newLink.href=location.href+"poll/"+data.permalinks[i],newLink.appendChild(newDiv),parentNode.appendChild(newLink)}})),location.pathname.match(/^\/mypolls$/)&&(socket.emit("list my polls",{}),socket.on("populate my polls",function(data){for(var parentNode=document.querySelector(".polls"),i=0;i<data.titles.length;i++){var newDiv=document.createElement("div");newDiv.className="poll__element--text",newDiv.textContent=data.titles[i];var newLink=document.createElement("a");newLink.className="poll__element--link",newLink.href=location.protocol+"//"+location.host+"/poll/"+data.permalinks[i],newLink.appendChild(newDiv),parentNode.appendChild(newLink)}})),location.pathname.match(/^\/createpoll\/?/i)&&!function(){var buttonCounter=3;document.querySelector(".form").addEventListener("click",function(e){if(e&&e.target.id.match(/^option-\d+$/)){var target=document.getElementById(e.target.id).parentNode;target.parentNode.removeChild(target)}e&&"option-create"===e.target.id&&(e.preventDefault(),addOption(buttonCounter),buttonCounter++)})}(),location.pathname.match(/^\/(?:signup|login|reset|createpoll)\/?/i)&&(document.querySelector("form").reset(),checkForm(location.pathname.toLowerCase().slice(1))),location.pathname.match(/^\/poll\/[0-9a-f-]+$/)){Array.prototype.forEach.call(document.querySelectorAll(".created-poll__option"),function(el){return el.addEventListener("click",function(e){switch(e.target.classList[e.target.classList.length-1]){case"created-poll__option--vote":displayModal("vote");break;case"created-poll__option--new-option":displayModal("new-option");break;case"created-poll__option--share":displayModal("share");break;case"created-poll__option--delete":displayModal("delete");break;default:console.log("uh oh...something went wrong.")}})}),document.querySelector(".modal__form--vote")&&!function(){var el_vote=document.querySelector(".modal__form--vote");el_vote.addEventListener("submit",function(e){e.preventDefault(),socket.emit("add vote",{vote:el_vote.firstChild.value,path:location.pathname.slice(6)})})}(),document.querySelector(".modal__form--new-option")&&!function(){var el_option=document.querySelector(".modal__form--new-option");el_option.addEventListener("submit",function(e){e.preventDefault(),socket.emit("add option",{option:el_option.firstChild.value,path:location.pathname.slice(6)})})}();var ctx=document.querySelector(".created-poll__poll--canvas"),myChart=new Chart(ctx,{type:"pie",data:{labels:optionText,datasets:[{data:voteCount,backgroundColor:["#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462","#B3DE69","#FCCDE5","#D9D9D9","#BC80BD","#CCEBC5","#FFED6F"]}]},options:{title:{display:!1,fontSize:14,text:pollTitle},legend:{display:!0,position:"bottom"},tooltips:{xPadding:10}}});if(socket.on("update poll",function(data){socket.emit("vote check",{path:location.pathname.slice(6)}),optionText=data.pollOptions.map(function(x){return x.optionText}),voteCount=data.pollOptions.map(function(x){return x.voteCount}),myChart.data.datasets[0].data=voteCount,myChart.data.labels=optionText,myChart.update()}),socket.on("voted",function(data){document.querySelector(".created-poll__option--vote").textContent="Voted",document.querySelector(".created-poll__option--vote").disabled=!0,document.querySelector(".created-poll__option--new-option").disabled=!0}),document.querySelector(".created-poll__title").textContent=pollTitle,document.querySelector(".created-poll__option--vote")){document.querySelector(".modal__vote--dropdown-li:nth-child(2)").textContent=optionText[0],document.querySelector(".modal__vote--dropdown-li:nth-child(3)").textContent=optionText[1];for(var i=2;i<optionText.length;i++){var nextOption=document.createElement("option");nextOption.classList.add("modal__vote--dropdown-li"),nextOption.textContent=optionText[i],document.querySelector(".modal__vote--dropdown-ul").appendChild(nextOption)}}}}},{}]},{},[1]);
//# sourceMappingURL=post.bundle.js.map
